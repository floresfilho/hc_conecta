<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HC Conecta - MVP</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .nav-buttons button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .nav-buttons button:hover {
            background-color: #0056b3;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Estilos do Check-in */
        .checkin-form {
            text-align: center;
        }

        .checkin-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .checkin-form input {
            width: 100%;
            max-width: 300px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
            margin: 0 auto 20px;
            display: block;
        }

        .checkin-form button[type="submit"] {
            width: 100%;
            max-width: 300px;
            padding: 12px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }

        .checkin-form button[type="submit"]:hover {
            background-color: #218838;
        }

        .confirmation-message {
            margin-top: 25px;
            padding: 20px;
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            text-align: center;
        }

        .confirmation-message-subtle {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745;
            color: #fff;
            padding: 12px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 1000;
        }

        .confirmation-message-subtle.show {
            opacity: 1;
        }

        /* Estilos da nova tela de guia */
        .patient-guide-card {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .patient-guide-card h2,
        .patient-guide-card h3 {
            color: #007bff;
        }

        .patient-guide-card p {
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* Estilos do Painel e Histórico */
        .patient-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .patient-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .patient-card:hover {
            transform: translateY(-3px);
            background-color: #f1f1f1;
        }

        .patient-info {
            flex-grow: 1;
        }

        .patient-name {
            font-size: 1.5em;
            margin: 0 0 5px;
        }

        .patient-id {
            font-size: 0.9em;
            color: #888;
            margin: 0;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8em;
            text-transform: uppercase;
            color: #fff;
            margin: 0 20px;
        }

        .status-badge.waiting {
            background-color: #ffc107;
        }

        .status-badge.in-service {
            background-color: #007bff;
        }

        .status-badge.done {
            background-color: #28a745;
        }

        .timeline-summary {
            font-size: 0.9em;
            color: #555;
            text-align: right;
        }

        @media (max-width: 600px) {
            .patient-card {
                flex-direction: column;
                align-items: flex-start;
            }

            .status-badge {
                margin: 10px 0;
            }

            .timeline-summary {
                text-align: left;
                margin-top: 10px;
            }
        }

        /* Estilos da Demonstração de Vestíveis */
        .wearable-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .wearable-data-card {
            background-color: #f0f8ff;
            border: 1px solid #d0e0f0;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 400px;
        }

        .wearable-data-card h3 {
            margin-top: 0;
            color: #007bff;
        }

        .data-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-group:last-child {
            border-bottom: none;
        }

        .data-group p {
            margin: 0;
            font-size: 1.1em;
            font-weight: 500;
        }

        .data-value {
            font-size: 1.5em !important;
            font-weight: 700 !important;
            color: #28a745;
        }

        /* Estilos do Fluxo Descentralizado */
        .decentralized-form-card {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .decentralized-form-card label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .decentralized-form-card input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
        }

        .decentralized-form-card button {
            width: 100%;
            margin-top: 20px;
            padding: 12px;
            background-color: #1890ff;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .decentralized-form-card button:hover {
            background-color: #096dd9;
        }

        /* Estilos da Tela de Detalhes do Paciente */
        .timeline-list {
            list-style: none;
            padding: 0;
            border-left: 2px solid #ccc;
            margin-left: 20px;
            position: relative;
        }

        .timeline-list li {
            position: relative;
            padding: 15px 20px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .timeline-list li.decentralized-exam {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
        }

        .timeline-list li:before {
            content: '';
            position: absolute;
            left: -27px;
            top: 25px;
            width: 12px;
            height: 12px;
            background: #007bff;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0 0 0 2px #007bff;
        }

        .timeline-list li h4 {
            margin: 0 0 5px;
            font-size: 1.2em;
            color: #007bff;
        }

        .timeline-list li p {
            margin: 0;
            font-size: 0.9em;
            color: #555;
        }
    </style>
</head>

<body>

    <main class="container">
        <div class="header">
            <h1>HC Conecta</h1>
            <p>Protótipo de MVP Integrado</p>
            <div class="nav-buttons">
                <button onclick="showPage('checkin-page')">Check-in</button>
                <button onclick="showPage('patient-guide-page')">Guia do Paciente</button>
                <button onclick="showPage('painel-page')">Painel da Equipe</button>
                <button onclick="showPage('patient-history-page')">Histórico do Dia</button>
                <button onclick="showPage('wearable-page')">HC Core</button>
                <button onclick="showPage('decentralized-page')">Agendamentos</button>
            </div>
        </div>

        <section id="checkin-page" class="page active">
            <div class="checkin-form">
                <h2>Check-in Inteligente</h2>
                <form id="checkinForm">
                    <label for="name">Nome Completo:</label>
                    <input type="text" id="name" name="name" placeholder="Ex: José Ferreira" required>
                    <label for="cpf">CPF ou CNS:</label>
                    <input type="text" id="cpf" name="cpf" placeholder="Ex: 123.456.789-00" required>
                    <label for="reason">Motivo da Visita:</label>
                    <input type="text" id="reason" name="reason" placeholder="Ex: Consulta com Cardiologista" required>
                    <button type="submit">Fazer Check-in</button>
                </form>
            </div>
        </section>

        <div id="subtle-confirmation" class="confirmation-message-subtle"></div>

        <section id="patient-guide-page" class="page">
            <div class="header">
                <h2>Guia do Paciente</h2>
                <p>Informações e orientações para o seu atendimento de hoje.</p>
            </div>
            <div class="patient-guide-card">
                <h3 id="guide-patient-name"></h3>
                <p>Você está aqui para o exame de **<span id="guide-exam-name"></span>**.</p>
                <p>Seu atendimento está agendado para às **<span id="guide-exam-time"></span>**.</p>
                <p>O local de atendimento é **<span id="guide-location"></span>**.</p>
                <p>Por favor, siga as sinalizações e dirija-se ao local. Um de nossos colaboradores estará à sua espera.
                </p>
            </div>
        </section>

        <section id="painel-page" class="page">
            <div class="header">
                <h2>Painel Assistencial</h2>
                <p>Acompanhe o status dos pacientes. Clique para ver o histórico completo.
                </p>
            </div>
            <div class="patient-list">
            </div>
        </section>

        <section id="patient-history-page" class="page">
            <div class="header">
                <h2>Histórico de Atendimento do Dia</h2>
                <p>Confira a lista de todos os pacientes que fizeram check-in hoje.</p>
            </div>
            <div class="patient-list" id="history-list">
            </div>
        </section>

        <section id="wearable-page" class="page">
            <div class="header">
                <h2>Monitoramento de Sinais Vitais</h2>
                <p>Dados de saúde em tempo real.</p>
            </div>
            <div id="wearable-list" class="wearable-list">
            </div>
        </section>

        <section id="decentralized-page" class="page">
            <div class="header">
                <h2>Cadastro de Exame Descentralizado</h2>
                <p>Indique o exame necessário para o paciente.</p>
            </div>
            <div class="decentralized-form-card">
                <form id="decentralizedForm">
                    <label for="patient-cpf">CPF do Paciente:</label>
                    <input type="text" id="patient-cpf" name="patient-cpf" placeholder="Ex: 123.456.789-00" required>
                    <label for="exam-description">Descrição do Exame:</label>
                    <input type="text" id="exam-description" name="exam-description"
                        placeholder="Ex: Hemograma completo" required>
                    <label for="exam-date">Data do Exame:</label>
                    <input type="date" id="exam-date" name="exam-date" required>
                    <button type="submit">Cadastrar Exame</button>
                </form>
                <div id="decentralized-confirmation" class="confirmation-message" style="display: none;">
                    <p id="decentralized-text">Exame cadastrado com sucesso.</p>
                </div>
            </div>
        </section>

        <section id="patient-details-page" class="page">
            <div class="header">
                <button onclick="showPage('painel-page')">← Voltar</button>
                <h2 id="patient-details-name">Detalhes do Paciente</h2>
                <p>Histórico completo de atividades.</p>
            </div>
            <ul id="timeline-list" class="timeline-list">
            </ul>
        </section>

    </main>

    <script>
        // === Parte de Dados e Lógica (API Simulada) ===
        let patientDatabase = [
            {
                name: "João da Silva",
                cpf: "123.456.789-00",
                status: "waiting",
                timeline: [{ date: "10/09/2025", description: "Raio-X em 10/09/2025", type: "regular" }],
                appointment: { exam: "Hemograma", time: "10:30h", location: "Unidade Lab Norte - Sala 3" }
            },
            {
                name: "Maria de Souza",
                cpf: "987.654.321-11",
                status: "in-service",
                timeline: [{ date: "01/08/2025", description: "Dermatologia em 01/08/2025", type: "regular" }],
                appointment: { exam: "Eletrocardiograma", time: "11:00h", location: "Bloco C - Setor de Cardiologia" }
            },
            {
                name: "Pedro Santos",
                cpf: "111.222.333-44",
                status: "done",
                timeline: [{ date: "15/09/2025", description: "Hemograma em 15/09/2025", type: "regular" }],
                appointment: { exam: "Ultrassonografia", time: "09:45h", location: "Imagem - Ala Sul" }
            }
        ];

        function checkinPatient(name, cpf, reason) {
            const existingPatient = patientDatabase.find(p => p.cpf === cpf);
            if (existingPatient) {
                return { success: false, message: "Paciente já fez o check-in." };
            }
            const newPatient = {
                name: name,
                cpf: cpf,
                status: "waiting",
                timeline: [{ date: new Date().toLocaleDateString('pt-BR'), description: `Check-in: ${reason}`, type: "regular" }],
                appointment: { exam: reason, time: `${Math.floor(Math.random() * (16 - 9 + 1)) + 9}:00h`, location: "Clínica de Especialidades - Andar 2" }
            };
            patientDatabase.push(newPatient);
            console.log(`Paciente ${newPatient.name} (CPF: ${newPatient.cpf}) adicionado. Total: ${patientDatabase.length}`);
            return { success: true, message: "Check-in realizado com sucesso.", patientData: newPatient };
        }

        function getPatients() {
            return patientDatabase;
        }

        function simulatePatientFlow() {
            const today = new Date().toLocaleDateString('pt-BR');
            patientDatabase.forEach(patient => {
                if (patient.status === 'waiting') {
                    patient.status = 'in-service';
                    patient.timeline.push({ date: today, description: "Consulta Iniciada", type: "regular" });
                } else if (patient.status === 'in-service') {
                    patient.status = 'done';
                    patient.timeline.push({ date: today, description: "Atendimento Concluído", type: "regular" });
                } else if (patient.status === 'done') {
                    patient.status = 'waiting';
                    patient.timeline.push({ date: today, description: "Retorno Agendado", type: "regular" });
                }
            });
            renderPatients();
        }

        // === Parte de Lógica da Interface (UI) ===
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            if (pageId === 'painel-page') {
                renderPatients();
            }
            if (pageId === 'wearable-page') {
                renderWearableData();
            }
            if (pageId === 'patient-history-page') {
                renderPatientHistory();
            }
        }

        function showPatientGuide(patient) {
            document.getElementById('guide-patient-name').textContent = `Olá, ${patient.name}!`;
            document.getElementById('guide-exam-name').textContent = patient.appointment.exam;
            document.getElementById('guide-exam-time').textContent = patient.appointment.time;
            document.getElementById('guide-location').textContent = patient.appointment.location;
            showPage('patient-guide-page');
        }

        function showPatientDetails(cpf) {
            const patient = patientDatabase.find(p => p.cpf === cpf);
            if (!patient) {
                alert("Paciente não encontrado!");
                return;
            }

            document.getElementById('patient-details-name').textContent = `Detalhes do Paciente: ${patient.name}`;
            const timelineList = document.getElementById('timeline-list');
            timelineList.innerHTML = '';

            // Lógica de ordenação e formatação
            patient.timeline.sort((a, b) => {
                const dateA = a.date.split('/').reverse().join('');
                const dateB = b.date.split('/').reverse().join('');
                return dateA.localeCompare(dateB);
            });

            patient.timeline.forEach(event => {
                const listItem = document.createElement('li');
                // Adicionando a classe de destaque se for um exame descentralizado
                if (event.type === 'decentralized-exam') {
                    listItem.classList.add('decentralized-exam');
                }
                listItem.innerHTML = `
                    <h4>${event.description}</h4>
                    <p>Data: ${event.date}</p>
                `;
                timelineList.appendChild(listItem);
            });

            showPage('patient-details-page');
        }

        const checkinForm = document.getElementById('checkinForm');
        checkinForm.addEventListener('submit', function (event) {
            event.preventDefault();
            const name = document.getElementById('name').value;
            const cpf = document.getElementById('cpf').value;
            const reason = document.getElementById('reason').value;
            const response = checkinPatient(name, cpf, reason);

            const subtleMessage = document.getElementById('subtle-confirmation');

            if (response.success) {
                subtleMessage.textContent = `Olá, ${name}! Check-in realizado.`;
                subtleMessage.classList.add('show');
                showPatientGuide(response.patientData);
            } else {
                subtleMessage.textContent = `Erro: ${response.message}`;
                subtleMessage.style.backgroundColor = '#dc3545';
                subtleMessage.classList.add('show');
            }

            setTimeout(() => {
                subtleMessage.classList.remove('show');
                subtleMessage.style.backgroundColor = '#28a745';
                checkinForm.reset();
            }, 3000);
        });

        function renderPatients() {
            const patientListContainer = document.querySelector('.patient-list');
            const patientsToRender = getPatients();
            patientListContainer.innerHTML = '';

            patientsToRender.forEach(patient => {
                const statusText = patient.status === 'waiting' ? 'Aguardando' : (patient.status === 'in-service' ? 'Em Atendimento' : 'Concluído');
                const statusClass = patient.status;

                const lastActivity = patient.timeline[patient.timeline.length - 1];
                const timelineSummary = `<strong>Última Atividade:</strong> ${lastActivity.description}`;

                const patientCardHTML = `
                    <div class="patient-card" data-status="${patient.status}" onclick="showPatientDetails('${patient.cpf}')">
                        <div class="patient-info">
                            <h2 class="patient-name">${patient.name}</h2>
                            <p class="patient-id">CPF: ${patient.cpf}</p>
                        </div>
                        <div class="status-badge ${statusClass}">${statusText}</div>
                        <div class="timeline-summary">
                            <p>${timelineSummary}</p>
                        </div>
                    </div>
                `;
                patientListContainer.innerHTML += patientCardHTML;
            });
        }

        function renderPatientHistory() {
            const historyListContainer = document.getElementById('history-list');
            const patientsToRender = getPatients();
            historyListContainer.innerHTML = '';

            patientsToRender.forEach(patient => {
                const firstCheckin = patient.timeline.find(event => event.description.startsWith('Check-in:'));
                const examReason = firstCheckin ? firstCheckin.description.replace('Check-in: ', '') : 'Não informado';

                const patientHistoryCardHTML = `
                    <div class="patient-card">
                        <div class="patient-info">
                            <h2 class="patient-name">${patient.name}</h2>
                            <p class="patient-id">CPF: ${patient.cpf}</p>
                            <p><strong>Motivo da Visita:</strong> ${examReason}</p>
                        </div>
                    </div>
                `;
                historyListContainer.innerHTML += patientHistoryCardHTML;
            });
        }

        function renderWearableData() {
            const wearableListContainer = document.getElementById('wearable-list');
            wearableListContainer.innerHTML = '';

            const patientsToRender = getPatients();

            patientsToRender.forEach(patient => {
                const heartRate = Math.floor(Math.random() * (90 - 70 + 1)) + 70;
                const bodyTemp = (Math.random() * (37.5 - 36.5) + 36.5).toFixed(1);

                const wearableCardHTML = `
                    <div class="wearable-data-card">
                        <h3>Paciente: ${patient.name}</h3>
                        <div class="data-group">
                            <p>Batimento Cardíaco:</p>
                            <p class="data-value">${heartRate} bpm</p>
                        </div>
                        <div class="data-group">
                            <p>Temperatura Corporal:</p>
                            <p class="data-value">${bodyTemp} °C</p>
                        </div>
                    </div>
                `;
                wearableListContainer.innerHTML += wearableCardHTML;
            });
        }

        const decentralizedForm = document.getElementById('decentralizedForm');
        decentralizedForm.addEventListener('submit', function (event) {
            event.preventDefault();

            const cpf = document.getElementById('patient-cpf').value;
            const examDescription = document.getElementById('exam-description').value;
            const examDate = document.getElementById('exam-date').value;

            const patient = patientDatabase.find(p => p.cpf === cpf);
            const confirmationMessage = document.getElementById('decentralized-confirmation');
            const confirmationText = document.getElementById('decentralized-text');

            if (patient) {
                const [year, month, day] = examDate.split('-');
                const formattedDate = `${day}/${month}/${year}`;

                patient.timeline.push({ date: formattedDate, description: `Exame Descentralizado: ${examDescription}`, type: "decentralized-exam" });
                confirmationText.textContent = `Exame cadastrado com sucesso para o paciente ${patient.name}.`;
            } else {
                confirmationText.textContent = `Erro: Paciente com CPF ${cpf} não encontrado.`;
            }

            confirmationMessage.style.display = 'block';
            setTimeout(() => {
                confirmationMessage.style.display = 'none';
                decentralizedForm.reset();
                renderPatients();
            }, 3000);
        });

        // Inicia as simulações
        setInterval(simulatePatientFlow, 7000);
        setInterval(renderWearableData, 2000);

        showPage('checkin-page');
    </script>
</body>

</html>